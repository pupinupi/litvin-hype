<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Litvin Hype</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<div id="gameScreen">

  <div id="board">
    <div id="cells"></div>
    <div id="tokenLayer"></div>
  </div>

  <div id="diceArea">
    <img id="diceImg" src="dice1.png">
    <button id="rollBtn">–ë—Ä–æ—Å–∏—Ç—å –∫—É–±–∏–∫</button>
  </div>

  <div id="info">–•–∞–π–ø: 0</div>

</div>

<!-- –ú–û–î–ê–õ–ö–ê –°–ö–ê–ù–î–ê–õ -->
<div id="scandalModal">
  <div id="scandalContent">
    <h3>–°–ö–ê–ù–î–ê–õ üî•</h3>
    <p id="scandalText"></p>
    <button onclick="closeScandal()">–û–ö</button>
  </div>
</div>

<script>
const board = document.getElementById("board");
const tokenLayer = document.getElementById("tokenLayer");
const rollBtn = document.getElementById("rollBtn");
const diceImg = document.getElementById("diceImg");
const info = document.getElementById("info");

let position = 0;
let hype = 0;
let canRoll = true;

const scandalCards = [
 "-1 —Ö–∞–π–ø",
 "-2 —Ö–∞–π–ø",
 "-3 —Ö–∞–π–ø",
 "-4 —Ö–∞–π–ø",
 "-5 —Ö–∞–π–ø",
 "-5 —Ö–∞–π–ø, –ø—Ä–æ–ø—É—Å—Ç–∏ —Ö–æ–¥"
];

// –∫–ª–µ—Ç–∫–∏ –ø–æ –ø–æ—Ä—è–¥–∫—É
const cellTypes = [
"start","+3","+2","scandal","risk","+2","scandal","+3","+5","zero",
"half","+3","risk","+3","skip","+2","scandal","+8","zero","+4"
];

// –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
const positions = [
{ x:113,y:588},{ x:108,y:464},{ x:108,y:345},{ x:108,y:235},{ x:108,y:135},
{ x:232,y:83},{ x:359,y:88},{ x:511,y:91},{ x:660,y:88},{ x:798,y:88},
{ x:920,y:119},{ x:903,y:243},{ x:901,y:351},{ x:895,y:461},{ x:895,y:580},
{ x:776,y:610},{ x:644,y:602},{ x:514,y:602},{ x:365,y:599},{ x:224,y:605}
];

// —Å–æ–∑–¥–∞–µ–º —Ñ–∏—à–∫—É
const token = document.createElement("div");
token.className="token";
token.style.background="red";
tokenLayer.appendChild(token);

moveToken(0);

rollBtn.onclick = ()=>{
 if(!canRoll) return;
 rollDice();
};

function rollDice(){
 canRoll=false;

 let roll = Math.floor(Math.random()*6)+1;
 animateDice(roll);
 animateMove(roll);
}

function animateDice(num){
 diceImg.classList.add("spin");
 setTimeout(()=>{
   diceImg.src="dice"+num+".png";
   diceImg.classList.remove("spin");
 },800);
}

function animateMove(steps){
 let i=0;
 let interval=setInterval(()=>{
   position=(position+1)%20;
   moveToken(position);
   highlight(position);
   i++;
   if(i>=steps){
     clearInterval(interval);
     setTimeout(()=>{
       applyCellEffect();
     },300);
   }
 },300);
}

function moveToken(pos){
 const p=positions[pos];
 token.style.transform=`translate(${p.x}px,${p.y}px)`;
}

function highlight(pos){
 document.querySelectorAll(".cellHighlight").forEach(c=>c.remove());
 const hl=document.createElement("div");
 hl.className="cellHighlight";
 hl.style.left=positions[pos].x+"px";
 hl.style.top=positions[pos].y+"px";
 board.appendChild(hl);
}

function applyCellEffect(){
 let type = cellTypes[position];

 if(type.startsWith("+")){
   let value=parseInt(type.replace("+",""));
   addHype(value);
 }

 if(type==="zero"){
   hype=0;
 }

 if(type==="half"){
   hype=Math.floor(hype/2);
 }

 if(type==="scandal"){
   showScandal();
   return;
 }

 if(type==="risk"){
   riskRoll();
   return;
 }

 updateInfo();
 canRoll=true;
}

function addHype(v){
 hype+=v;
}

function updateInfo(){
 info.innerHTML="–•–∞–π–ø: "+hype;
}

function showScandal(){
 const card=scandalCards[Math.floor(Math.random()*scandalCards.length)];
 document.getElementById("scandalText").innerText=card;
 document.getElementById("scandalModal").style.display="flex";

 let minus=parseInt(card);
 if(!isNaN(minus)){
   hype+=minus;
   if(hype<0) hype=0;
 }
 updateInfo();
}

function closeScandal(){
 document.getElementById("scandalModal").style.display="none";
 canRoll=true;
}

function riskRoll(){
 let roll=Math.floor(Math.random()*6)+1;
 animateDice(roll);

 setTimeout(()=>{
   if(roll<=3){
     hype-=5;
   }else{
     hype+=5;
   }
   if(hype<0) hype=0;
   updateInfo();
   canRoll=true;
 },1000);
}
</script>

</body>
</html>
