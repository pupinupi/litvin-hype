<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Litvin Hype</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<div id="startScreen">
<h2>Litvin Hype</h2>

<input id="nameInput" placeholder="Имя">
<input id="roomInput" placeholder="Код комнаты">

<div id="colors">
<div class="choice" data-color="red" style="background:red;"></div>
<div class="choice" data-color="blue" style="background:blue;"></div>
<div class="choice" data-color="green" style="background:green;"></div>
<div class="choice" data-color="yellow" style="background:yellow;"></div>
</div>

<button id="joinBtn">Играть</button>
</div>

<div id="gameScreen" style="display:none;">
<h3>Игра</h3>
<div id="info"></div>
<button id="rollBtn">Бросить кубик</button>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>

const socket = io();

let selectedColor = null;
let myRoom = null;
let state = null;

const nameInput = document.getElementById("nameInput");
const roomInput = document.getElementById("roomInput");
const joinBtn = document.getElementById("joinBtn");
const startScreen = document.getElementById("startScreen");
const gameScreen = document.getElementById("gameScreen");
const rollBtn = document.getElementById("rollBtn");
const info = document.getElementById("info");

// выбор цвета
document.querySelectorAll(".choice").forEach(c=>{
  c.onclick = function(){
    document.querySelectorAll(".choice").forEach(x=>x.classList.remove("sel"));
    this.classList.add("sel");
    selectedColor = this.getAttribute("data-color");
  };
});

// вход
joinBtn.onclick = function(){

  const name = nameInput.value.trim();
  const room = roomInput.value.trim();

  if(!name || !room || !selectedColor){
    alert("Заполните всё");
    return;
  }

  myRoom = room;

  socket.emit("joinRoom", {
    name: name,
    room: room,
    color: selectedColor
  });

  startScreen.style.display = "none";
  gameScreen.style.display = "block";
};

// состояние
socket.on("state", function(newState){
  state = newState;

  let html = "<h3>Игроки:</h3>";

  state.players.forEach(p=>{
    html += "<div style='color:"+p.color+"'>" +
            p.name + " — " + p.hype + " хайп</div>";
  });

  info.innerHTML = html;
});

// кубик
rollBtn.onclick = function(){
  socket.emit("rollDice", myRoom);
};

</script>

</body>
</html>
